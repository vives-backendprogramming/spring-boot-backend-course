# PizzaStore with DTOs

This project demonstrates the complete implementation of DTOs (Data Transfer Objects) with MapStruct for the PizzaStore application.

## ğŸ“‹ What's Demonstrated

- âœ… **Separate DTOs** for requests and responses
- âœ… **MapStruct** for compile-time safe mapping
- âœ… **Validation** with Bean Validation annotations
- âœ… **Proper layering** with domain, DTO, mapper, service, and controller packages
- âœ… **JPA entities** with lifecycle callbacks (@PrePersist, @PreUpdate)
- âœ… **H2 in-memory database** with sample data

## ğŸ—ï¸ Project Structure

```
src/main/java/be/vives/pizzastore/
â”œâ”€â”€ domain/
â”‚   â””â”€â”€ Pizza.java                    # JPA Entity
â”œâ”€â”€ dto/
â”‚   â”œâ”€â”€ request/
â”‚   â”‚   â”œâ”€â”€ CreatePizzaRequest.java   # DTO for creating pizzas
â”‚   â”‚   â””â”€â”€ UpdatePizzaRequest.java   # DTO for updating pizzas
â”‚   â””â”€â”€ response/
â”‚       â””â”€â”€ PizzaResponse.java        # DTO for returning pizzas
â”œâ”€â”€ mapper/
â”‚   â””â”€â”€ PizzaMapper.java              # MapStruct mapper interface
â”œâ”€â”€ repository/
â”‚   â””â”€â”€ PizzaRepository.java          # Spring Data JPA repository
â”œâ”€â”€ service/
â”‚   â””â”€â”€ PizzaService.java             # Business logic layer
â”œâ”€â”€ controller/
â”‚   â””â”€â”€ PizzaController.java          # REST API endpoints
â””â”€â”€ PizzaStoreApplication.java        # Main application class
```

## ğŸš€ How to Run

### Prerequisites
- Java 25 or higher
- Maven 3.6 or higher

### Run the Application

```bash
# Navigate to project directory
cd pizzastore-with-dtos

# Run with Maven
mvn spring-boot:run
```

The application will start on `http://localhost:8080`

### Access H2 Console

Open your browser and navigate to: `http://localhost:8080/h2-console`

**Connection settings:**
- JDBC URL: `jdbc:h2:mem:pizzastore`
- Username: `sa`
- Password: (leave empty)

## ğŸ§ª Test the API

### Get all pizzas
```bash
curl http://localhost:8080/api/pizzas
```

### Get a specific pizza
```bash
curl http://localhost:8080/api/pizzas/1
```

### Create a new pizza
```bash
curl -X POST http://localhost:8080/api/pizzas \
  -H "Content-Type: application/json" \
  -d '{
    "name": "Diavola",
    "price": 10.50,
    "description": "Spicy salami, mozzarella, and chili peppers"
  }'
```

### Update a pizza
```bash
curl -X PUT http://localhost:8080/api/pizzas/1 \
  -H "Content-Type: application/json" \
  -d '{
    "name": "Margherita Deluxe",
    "price": 9.00,
    "description": "Classic tomato sauce, premium mozzarella, and fresh basil"
  }'
```

### Delete a pizza
```bash
curl -X DELETE http://localhost:8080/api/pizzas/1
```

## ğŸ¯ Key Concepts Demonstrated

### 1. Request DTOs
- No `id` field (generated by database)
- Validation annotations (`@NotBlank`, `@NotNull`, `@DecimalMin`)
- Only fields that clients can set

### 2. Response DTOs
- Includes `id` field
- Includes timestamps (`createdAt`, `updatedAt`)
- Read-only representation

### 3. MapStruct Mapper
- Compile-time code generation
- Type-safe mapping
- Automatic field mapping by name
- Custom mappings with `@Mapping` annotations
- `@MappingTarget` for updating existing entities

### 4. Entity Never Exposed
- Entity is used only in service and repository layers
- Controller only works with DTOs
- No security risks or tight coupling

## ğŸ” Generated Code

MapStruct generates the mapper implementation at compile time.
Check the generated code in:
```
target/generated-sources/annotations/be/vives/pizzastore/mapper/PizzaMapperImpl.java
```

## ğŸ“š Related Lesson

This project accompanies **Lesson 6: DTOs & Mappers** from the Backend Programming Course.

See `../README.md` for the complete lesson.
